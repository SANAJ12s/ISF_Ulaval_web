import{_ as M,f as y,g as T,h as B,i as O,q as P,k as A,l as z,m as G,p as H,o as i,c as n,a as t,s as R,u as $,d as _,t as d,b as c,v as m,x as p,y as X,F as Y,r as J,D as V,E as K,z as L,A as k,G as S,n as Q,H as W}from"./index-0876195e.js";const Z={class:"admin"},ee={class:"container py-5"},te={class:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4"},se={key:0,class:"card mb-4"},le=["disabled"],oe={key:0,class:"mt-2 text-danger mb-0"},ie={class:"card mb-4"},ne={class:"d-flex align-items-start justify-content-between gap-3 flex-wrap"},ae={class:"h5 fw-bold mb-3"},re={key:0,class:"text-white-50 small"},de={class:"row g-3"},ue={class:"col-md-7"},ce={class:"col-md-5"},me={class:"col-md-6"},ve={class:"col-md-6"},pe={class:"col-md-6"},fe={class:"col-md-6"},be={class:"col-12"},_e={class:"col-md-6"},ge={class:"col-md-3"},ye={class:"col-md-3"},ke={class:"col-12 d-flex flex-wrap gap-2 align-items-center"},he=["disabled"],Ve=["disabled"],xe={key:1,class:"text-danger ms-2"},Ue={class:"card"},we={class:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3"},Ae={class:"badge"},Ce={key:0,class:"empty"},Ee={key:1,class:"empty"},Le={key:2,class:"list"},Se={class:"info"},De={class:"top"},Ne={class:"name"},Fe={class:"meta"},Ie={key:0,class:"pill"},je={class:"pill muted-pill"},qe={key:1,class:"pill muted-pill"},Me={key:0},Te={key:0,class:"desc"},Be={key:1,class:"desc"},Oe={class:"links"},Pe=["href"],ze=["href"],Ge={class:"actions"},He=["onClick","disabled"],Re=["onClick","disabled"],$e={__name:"AdminEvents",setup(Xe){const h=y([]),b=y(!0),a=y(!1),u=y(""),v=y(null);let x=null;const s=T({title:"",category:"",date:"",time:"",location:"",description:"",link:"",imageUrl:"",order:1,isVisible:!0}),U=B(()=>[...h.value].sort((o,e)=>(o.order??999)-(e.order??999)));function w(){s.title="",s.category="",s.date="",s.time="",s.location="",s.description="",s.link="",s.imageUrl="",s.order=1,s.isVisible=!0}function D(){var o;return(o=s.title)!=null&&o.trim()?s.date?"":"La date est requise.":"Le titre est requis."}async function N(){var e,r,l,g,E;u.value="";const o=D();if(o){u.value=o;return}a.value=!0;try{const f={title:s.title.trim(),category:((e=s.category)==null?void 0:e.trim())||"",date:s.date,time:s.time||"",location:((r=s.location)==null?void 0:r.trim())||"",description:((l=s.description)==null?void 0:l.trim())||"",link:((g=s.link)==null?void 0:g.trim())||"",imageUrl:((E=s.imageUrl)==null?void 0:E.trim())||"",order:Number.isFinite(s.order)?Number(s.order):999,isVisible:!!s.isVisible,updatedAt:V()};v.value?(await K(L(k,"events",v.value),f),v.value=null,w()):(await S(A(k,"events"),{...f,createdAt:V()}),w())}catch(f){console.error(f),u.value=(f==null?void 0:f.message)||"Erreur Firestore"}finally{a.value=!1}}function F(o){v.value=o.id,s.title=o.title||"",s.category=o.category||"",s.date=o.date||"",s.time=o.time||"",s.location=o.location||"",s.description=o.description||"",s.link=o.link||"",s.imageUrl=o.imageUrl||"",s.order=Number.isFinite(o.order)?o.order:999,s.isVisible=o.isVisible!==!1}function C(){v.value=null,w()}async function I(o){if(u.value="",!(!o||!window.confirm("Supprimer cet Ã©vÃ©nement ?"))){a.value=!0;try{await W(L(k,"events",o)),v.value===o&&C()}catch(r){console.error(r),u.value=(r==null?void 0:r.message)||"Erreur suppression"}finally{a.value=!1}}}function j(o){try{const[e,r,l]=o.split("-").map(Number);return new Date(e,r-1,l).toLocaleDateString("fr-CA",{year:"numeric",month:"long",day:"numeric"})}catch{return o}}async function q(){if(u.value="",a.value||h.value.length>0)return;const o=[{title:"Atelier CV â€” ISF ULaval",category:"Atelier",date:"2026-01-20",time:"18:00",location:"UniversitÃ© Laval",description:"Atelier pour amÃ©liorer ton CV + conseils recrutement.",link:"",imageUrl:"",order:1,isVisible:!0,createdAt:V(),updatedAt:V()}];a.value=!0;try{for(const e of o)await S(A(k,"events"),e)}catch(e){console.error(e),u.value=(e==null?void 0:e.message)||"Import impossible"}finally{a.value=!1}}return O(()=>{b.value=!0;const o=P(A(k,"events"));x=z(o,e=>{h.value=e.docs.map(r=>({id:r.id,...r.data()})),b.value=!1},e=>{console.error(e),u.value=(e==null?void 0:e.message)||"Erreur de chargement",b.value=!1})}),G(()=>{x&&x()}),(o,e)=>{const r=H("router-link");return i(),n("main",Z,[t("div",ee,[t("div",te,[e[11]||(e[11]=t("div",null,[t("h1",{class:"title"},"Gestion â€” Ã‰vÃ©nements"),t("p",{class:"subtitle"},"CrÃ©e, modifie et supprime les Ã©vÃ©nements affichÃ©s sur la page dâ€™accueil.")],-1)),R(r,{class:"btn-back",to:"/admin"},{default:$(()=>[...e[10]||(e[10]=[_("â† Retour au dashboard",-1)])]),_:1})]),!b.value&&h.value.length===0?(i(),n("div",se,[e[12]||(e[12]=t("h2",{class:"h5 fw-bold mb-2"},"Importer des Ã©vÃ©nements de base",-1)),e[13]||(e[13]=t("p",{class:"muted mb-3"},[_(" Ta collection "),t("code",null,"events"),_(" est vide. Clique pour importer un exemple (tu peux en ajouter plusieurs). ")],-1)),t("button",{class:"btn-primary",onClick:q,disabled:a.value},d(a.value?"...":"Importer maintenant"),9,le),u.value?(i(),n("p",oe,d(u.value),1)):c("",!0)])):c("",!0),t("div",ie,[t("div",ne,[t("h2",ae,d(v.value?"Modifier un Ã©vÃ©nement":"Nouvel Ã©vÃ©nement"),1),b.value?(i(),n("div",re,"Synchronisationâ€¦")):c("",!0)]),t("div",de,[t("div",ue,[e[14]||(e[14]=t("label",{class:"form-label"},"Titre",-1)),m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.title=l),class:"form-control",placeholder:"Ex: Atelier CV / SoirÃ©e recrutement"},null,512),[[p,s.title,void 0,{trim:!0}]])]),t("div",ce,[e[15]||(e[15]=t("label",{class:"form-label"},"CatÃ©gorie (optionnel)",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.category=l),class:"form-control",placeholder:"Ex: ActivitÃ© / ConfÃ©rence"},null,512),[[p,s.category,void 0,{trim:!0}]])]),t("div",me,[e[16]||(e[16]=t("label",{class:"form-label"},"Date",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.date=l),type:"date",class:"form-control"},null,512),[[p,s.date]])]),t("div",ve,[e[17]||(e[17]=t("label",{class:"form-label"},"Heure (optionnel)",-1)),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.time=l),type:"time",class:"form-control"},null,512),[[p,s.time,void 0,{trim:!0}]])]),t("div",pe,[e[18]||(e[18]=t("label",{class:"form-label"},"Lieu (optionnel)",-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.location=l),class:"form-control",placeholder:"Ex: ULaval, Pavillon X, Local Y"},null,512),[[p,s.location,void 0,{trim:!0}]])]),t("div",fe,[e[19]||(e[19]=t("label",{class:"form-label"},"Image (URL optionnelle)",-1)),m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.imageUrl=l),class:"form-control",placeholder:"https://..."},null,512),[[p,s.imageUrl,void 0,{trim:!0}]]),e[20]||(e[20]=t("small",{class:"muted"},"Plus tard : upload via Firebase Storage si tu veux.",-1))]),t("div",be,[e[21]||(e[21]=t("label",{class:"form-label"},"Description (optionnel)",-1)),m(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.description=l),class:"form-control",rows:"3",placeholder:"Infos, objectifs, inscription, etc."},null,512),[[p,s.description,void 0,{trim:!0}]])]),t("div",_e,[e[22]||(e[22]=t("label",{class:"form-label"},"Lien (optionnel)",-1)),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>s.link=l),class:"form-control",placeholder:"https://... (inscription, fb event...)"},null,512),[[p,s.link,void 0,{trim:!0}]])]),t("div",ge,[e[23]||(e[23]=t("label",{class:"form-label"},"Ordre",-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>s.order=l),type:"number",class:"form-control",placeholder:"1"},null,512),[[p,s.order,void 0,{number:!0}]]),e[24]||(e[24]=t("small",{class:"muted"},"Plus petit = affichÃ© en premier.",-1))]),t("div",ye,[e[26]||(e[26]=t("label",{class:"form-label"},"Afficher",-1)),m(t("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>s.isVisible=l),class:"form-select"},[...e[25]||(e[25]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)])],512),[[X,s.isVisible]])]),t("div",ke,[t("button",{class:"btn-primary",onClick:N,disabled:a.value},d(a.value?"...":v.value?"Enregistrer":"Ajouter"),9,he),v.value?(i(),n("button",{key:0,class:"btn-ghost",onClick:C,disabled:a.value}," Annuler ",8,Ve)):c("",!0),u.value?(i(),n("span",xe,d(u.value),1)):c("",!0)])])]),t("div",Ue,[t("div",we,[e[27]||(e[27]=t("h2",{class:"h5 fw-bold mb-0"},"Ã‰vÃ©nements",-1)),t("span",Ae,d(U.value.length)+" total",1)]),b.value?(i(),n("div",Ce,"Chargementâ€¦")):U.value.length===0?(i(),n("div",Ee," Aucun Ã©vÃ©nement pour le moment. Ajoute-en un ðŸ‘† ")):(i(),n("div",Le,[(i(!0),n(Y,null,J(U.value,l=>(i(),n("div",{key:l.id,class:"item"},[t("div",Se,[t("div",De,[t("div",Ne,d(l.title),1),t("div",Fe,[l.category?(i(),n("span",Ie,d(l.category),1)):c("",!0),t("span",je,"Ordre: "+d(l.order??999),1),l.date?(i(),n("span",qe,[_(d(j(l.date))+" ",1),l.time?(i(),n("span",Me,"â€¢ "+d(l.time),1)):c("",!0)])):c("",!0),t("span",{class:Q(["pill",l.isVisible?"ok":"off"])},d(l.isVisible?"Visible":"MasquÃ©"),3)])]),l.location?(i(),n("p",Te,"ðŸ“ "+d(l.location),1)):c("",!0),l.description?(i(),n("p",Be,d(l.description),1)):c("",!0),t("div",Oe,[l.link?(i(),n("a",{key:0,class:"link",href:l.link,target:"_blank",rel:"noreferrer"},"Ouvrir le lien",8,Pe)):c("",!0),l.imageUrl?(i(),n("a",{key:1,class:"link",href:l.imageUrl,target:"_blank",rel:"noreferrer"},"Voir lâ€™image",8,ze)):c("",!0)])]),t("div",Ge,[t("button",{class:"btn-small",onClick:g=>F(l),disabled:a.value},"Modifier",8,He),t("button",{class:"btn-small danger",onClick:g=>I(l.id),disabled:a.value},"Supprimer",8,Re)])]))),128))])),e[28]||(e[28]=t("p",{class:"hint"},[_(" âœ… Firestore branchÃ© : "),t("code",null,"events"),_(" â€¢ Ajout / modif / suppression = persistant. ")],-1))])])])}}},Je=M($e,[["__scopeId","data-v-98b66cac"]]);export{Je as default};
